<div class="tool-section">
    <h2><i class="fas fa-crop" title="Crop Image"></i>Crop Image</h2>

    <div id="crop-drop-zone" class="drop-zone mb-6" title="Drag and drop an image or click to select a file">
        <i class="fas fa-file-image"></i>
        <p class="font-semibold">Drop image here or click to upload</p>
        <p class="text-sm text-neutral-medium">(Supports JPG, PNG, GIF, etc.)</p>
    </div>
    <input type="file" id="crop-file-input" accept="image/*" class="hidden">

    <div id="crop-canvas-container" class="my-6 w-full flex justify-center items-center bg-neutral-darkest p-2 rounded-md shadow-inner" style="min-height: 200px;">
        <canvas id="crop-canvas" class="hidden shadow-lg rounded-sm border border-neutral-dark" style="max-width: 100%; height: auto;"></canvas>
    </div>

    <div id="crop-loading" class="loading-spinner-container hidden">
        <div class="spinner"></div>
        <p class="ml-4 text-neutral-light">Loading image for cropping...</p>
    </div>

    <div id="crop-controls-panel" class="controls-panel mt-2 hidden">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 mb-8 items-end">
            <div>
                <label for="crop-aspect-ratio" class="block text-sm font-medium text-neutral-lighter mb-1">Aspect Ratio:</label>
                <div class="relative">
                    <select id="crop-aspect-ratio" class="form-select block w-full pl-3 pr-10 py-2.5 text-base border-neutral-medium bg-neutral-dark focus:outline-none focus:ring-primary focus:border-primary sm:text-sm rounded-md appearance-none" title="Select a predefined aspect ratio or choose 'Free'">
                        <option value="free">Free</option>
                        <option value="original">Original</option>
                        <option value="1:1">1:1 Square (Profile, Instagram)</option>
                        <option disabled class="text-neutral-medium">-- Social Media --</option>
                        <option value="16:9">16:9 Landscape (YouTube, Banners)</option>
                        <option value="9:16">9:16 Portrait (Stories, TikTok)</option>
                        <option value="4:5">4:5 Portrait (Instagram Feed)</option>
                        <option value="2:1">2:1 Landscape (Twitter Header)</option>
                        <option value="3:2">3:2 Landscape (Facebook)</option>
                        <option disabled class="text-neutral-medium">-- Print & Standard --</option>
                        <option value="4:3">4:3 Standard Monitor/Photo</option>
                        <option value="3:4">3:4 Portrait Photo</option>
                        <option value="5:7">5:7 Photo Print</option>
                        <option value="1.414:1">A-Series Paper (approx âˆš2:1)</option>
                    </select>
                    <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-neutral-lightest">
                        <svg class="fill-current h-5 w-5" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z"/></svg>
                    </div>
                </div>
            </div>
            <div class="flex items-center justify-center md:justify-start md:pb-1">
                <label class="flex items-center text-sm text-neutral-lighter cursor-pointer" title="Lock the current aspect ratio while resizing the crop box">
                    <input type="checkbox" id="crop-lock-aspect" class="form-checkbox h-5 w-5 text-primary bg-neutral-dark border-neutral-medium rounded focus:ring-primary focus:ring-offset-neutral-darker" />
                    <span class="ml-2">Lock Aspect Ratio</span>
                </label>
            </div>
        </div>

        <div class="flex flex-wrap justify-center items-center gap-4 mt-6">
            <button id="crop-do-crop-btn" class="btn btn-primary" title="Apply the current crop selection to the image">
                <i class="fas fa-check"></i>Apply Crop
            </button>
            <button id="crop-reset-btn" class="btn btn-outline" title="Reset the image and crop selection to the original state">
                <i class="fas fa-undo"></i>Reset
            </button>
            <button id="crop-download-btn" class="btn btn-secondary hidden" title="Download the cropped image">
                <i class="fas fa-download"></i>Download
            </button>
        </div>
    </div>
     <p id="crop-initial-message" class="text-center text-neutral-medium mt-4 py-8">Upload an image to start cropping. The interactive cropper will appear here.</p>
</div>
